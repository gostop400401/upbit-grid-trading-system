# 🔄 Workflow 개선 완료

**마지막 업데이트**: 2025-12-16 (개선판)  
**개선 이유**: 실제 테스트 기반 검증

---

## ✅ 개선 사항

### Before (초기 버전)
- ❌ SSH 인터랙티브 모드 사용
- ❌ 복잡한 Python 이스케이프
- ❌ systemctl 타임아웃 문제
- ❌ 에러 발생 명령 포함

### After (개선판) ✨
- ✅ 원라이너 SSH 명령만 사용
- ✅ 로컬에서 Python 실행
- ✅ 검증된 명령만 포함
- ✅ 대체 방법 제시
- ✅ 명확한 체크리스트

---

## 📋 사용 가능한 Workflow (개선판)

### 1. `/deploy` - 코드 배포 ⭐⭐⭐
**장점:**
- Git push부터 재시작까지 자동화
- 명확한 성공/실패 확인
- 롤백 절차 포함

**주요 단계:**
1. Git 상태 확인
2. 커밋 & 푸시
3. 서버 업데이트
4. 봇 재시작
5. 로그 확인
6. Discord 테스트

### 2. `/bug-analysis` - 버그 분석 ⭐⭐⭐
**장점:**
- DB 다운로드 자동화
- 로컬 분석 (이스케이프 문제 없음)
- 단계별 가이드

**주요 단계:**
1. DB 다운로드 (자동)
2. 최근 계약 확인 (로컬)
3. 중복 확인 (로컬)
4. 로그 다운로드 (필요시)
5. 로그 분석 (VSCode)
6. 리포트 작성

### 3. `/healthcheck` - 상태 점검 ⭐⭐
**장점:**
- 빠른 전체 상태 확인 (5분)
- 검증된 명령만 사용
- 문제 발견 시 대응 방법 제시

**주요 단계:**
1. 프로세스 확인
2. 디스크 사용량
3. DB 상태
4. 로그 확인
5. 활성 계약 (Discord)
6. 재부팅 필요 여부

---

## 🚀 사용 방법

### 슬래시 명령어 (추천)
```
/deploy
/bug-analysis
/healthcheck
```

### 자연어
```
배포해줘
버그 분석 workflow 실행
헬스체크 해줘
```

---

## ⚡ // turbo 자동화

`// turbo` 주석이 있는 단계는 자동 실행됩니다.

### 자동 실행 단계:
- ✅ Git 상태 확인
- ✅ 서버 명령 (조회)
- ✅ DB 다운로드
- ✅ 프로세스 확인

### 수동 확인 단계:
- ❌ Git 커밋 (메시지 입력 필요)
- ❌ 복잡한 분석 (사용자 판단 필요)
- ❌ 파일 수정

---

## 💡 Best Practices

### 1. 배포 전 체크리스트
- [ ] 로컬 테스트 완료
- [ ] .env 파일 제외 확인
- [ ] 커밋 메시지 명확

### 2. 버그 분석 시
- [ ] DB 먼저 다운로드
- [ ] 로컬에서 분석
- [ ] 리포트 작성

### 3. 정기 헬스체크
- [ ] 주 1-2회 실행
- [ ] 배포 직후 실행
- [ ] 이상 징후 발견 시

---

## 📝 Workflow 파일 위치

```
.agent/workflows/
├── deploy.md          ✅ 배포
├── bug-analysis.md    ✅ 버그 분석
└── healthcheck.md     ✅ 상태 점검
```

---

## 🎯 다음 개선 계획

### 추가 예정:
1. **백업 workflow** - DB & 설정 백업
2. **롤백 workflow** - 이전 버전 복구
3. **성능 테스트** - API 응답 속도 측정

### 개선 예정:
- 더 많은 자동화
- 결과 리포트 자동 생성
- Discord 알림 통합

---

## 📚 관련 문서

- `MAINTENANCE.md` - 일반 유지보수
- `Dev_logs/2025-12-16_playbook_debugging.md` - 디버깅 플레이북
- `DEBUGGING_PLAYBOOK.md` - 상세 디버깅 가이드

---

**작성자**: Google Antigravity + 실제 테스트  
**검증**: 2025-12-16 healthcheck 실행 후 개선
